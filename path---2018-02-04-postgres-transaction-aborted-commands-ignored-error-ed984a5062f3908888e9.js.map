{"version":3,"sources":["webpack:///path---2018-02-04-postgres-transaction-aborted-commands-ignored-error-ed984a5062f3908888e9.js","webpack:///./.cache/json/2018-02-04-postgres-transaction-aborted-commands-ignored-error.json"],"names":["webpackJsonp","854","module","exports","data","post","id","html","fields","slug","prefix","frontmatter","title","subTitle","cover","author","footnote","site","siteMetadata","facebook","appId","pathContext"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,MAAQC,GAAA,0KAAAC,KAAA,wsEAAohCC,QAAk6CC,KAAA,mEAAAC,OAAA,IAAsFC,aAAgBC,MAAA,4FAAAC,SAAA,KAAAC,MAAA,OAAkIC,QAAWT,GAAA,4GAAAC,KAAA,oNAA2US,UAAaV,GAAA,8GAAAC,KAAA,iWAAkeU,MAASC,cAAgBC,UAAYC,MAAA,sBAA6BC,aAAgBZ,KAAA","file":"path---2018-02-04-postgres-transaction-aborted-commands-ignored-error-ed984a5062f3908888e9.js","sourcesContent":["webpackJsonp([249920095221113],{\n\n/***/ 854:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"post\":{\"id\":\"/Users/thanhchungbui/Desktop/thanhchungbtcblog/content/posts/2018-02-04-postgres-transaction-aborted-commands-ignored-error/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>先日Postgres マネジャーツールでクエリを実行する時下記のエラーが出てきました。</p>\\n<blockquote>\\n<p>current transaction is aborted, commands ignored until end of transaction block\\nその後は正常なクエリを打ったのに何も実行できず、困っていました。</p>\\n</blockquote>\\n<p>これはトランザクションの中に一度エラーが発生すると、明示的にでトランザクションを終了させないと（<code class=\\\"language-text\\\">abort</code>,<code class=\\\"language-text\\\">commit</code>）次のクエリは受け取らないようです。\\n例えば</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-sql\\\"><code class=\\\"language-sql\\\"><span class=\\\"token keyword\\\">begin</span><span class=\\\"token punctuation\\\">;</span>\\nselet <span class=\\\"token operator\\\">*</span> <span class=\\\"token keyword\\\">from</span> foo<span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>を実行としましょう。\\nすると、「ERROR: syntax error at or near ‘selet’“」というエラーが投げられます。\\nここでクエリを修正し、再度実行します。\\n<code class=\\\"language-text\\\">select * from foo;</code>\\nでも冒頭のメッセージが出て、実行ができません。\\nトランザクションの中でエラーが発生した場合\\n<code class=\\\"language-text\\\">rollback</code>\\nで一度終了させる必要があるという意味です。\\nさ、これで再度実行してみましょう。</p>\\n<p>このエラーはもし<code class=\\\"language-text\\\">psql</code>で実行すればすぐわかると思うんだけど、<code class=\\\"language-text\\\">pgAdmin</code>等でクエリを試したらなかなか気づきにくく、知っておけばよかったと思います。</p>\\n<p><a href=\\\"%60transaction%60%E3%81%AE%E5%87%A6%E7%90%86\\\">https://github.com/postgres/postgres/blob/master/src/backend/access/transam/README</a>によると、でユーザーが中止するとシステムの具合で中止する処理は区別しているようです。</p>\\n<blockquote>\\n<ul>\\n<li>AbortCurrentTransaction (システムの都合）アプリケーション状態はTBLOCK_ABORT</li>\\n<li>UserAbortTransactionBlock (ユーザーが<code class=\\\"language-text\\\">rollback</code>や<code class=\\\"language-text\\\">commit</code>を実行）アプリケーション状態はTBLOCK<em>ABORT</em>END</li>\\n</ul>\\n</blockquote>\\n<p>では、なんでその場合<code class=\\\"language-text\\\">postgres</code>は自動にTransactionを終了させてくれないの？こうすると毎回Syntaxとかタイプミス等で<code class=\\\"language-text\\\">rollback</code>を打たないといけなく、面倒くさいなと思うんでしょう。\\n例えば、長いトランザクションの中にタイプミスで最初から始めないといけないとなら。。。\\nもし<code class=\\\"language-text\\\">psql</code>を使用したら<code class=\\\"language-text\\\">onerrorrollback</code>という設定を指定することで自動に<code class=\\\"language-text\\\">rollback</code>してくれます。</p>\\n<p>詳しく読みたい場合は<a href=\\\"OnErrorRollBack%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%EF%BC%88%E8%91%97%E4%BD%9C%E8%80%85%E3%81%AE%E3%83%96%E3%83%AD%E3%82%B0%EF%BC%89\\\">https://www.endpoint.com/blog/2015/02/24/postgres-onerrorrollback-explained</a>をご参照ください。</p>\",\"fields\":{\"slug\":\"/2018-02-04-postgres-transaction-aborted-commands-ignored-error/\",\"prefix\":\"\"},\"frontmatter\":{\"title\":\"postgres: current transaction is aborted, commands ignored until end of transaction block\",\"subTitle\":null,\"cover\":null}},\"author\":{\"id\":\"/Users/thanhchungbui/Desktop/thanhchungbtcblog/content/parts/author.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>My name is <strong>Thanh Chung</strong>, a Web Developer. I love reactjs and javascript stacks but it’s really hard. English is not my first language but this blog is aimed to improve my writing skill.</p>\"},\"footnote\":{\"id\":\"/Users/thanhchungbui/Desktop/thanhchungbtcblog/content/parts/footnote.md absPath of file >>> MarkdownRemark\",\"html\":\"<ul>\\n<li>this blog is forked from   <a href=\\\"https://github.com/greglobinski/gatsby-starter-personal-blog\\\">gatsby-starter-personal-blog-starter-kit</a></li>\\n<li>built by <a href=\\\"https://www.greglobinski.com\\\">greg lobinski</a></li>\\n<li>with <a href=\\\"https://www.gatsbyjs.org/\\\">Gatsby</a> &#x26; <a href=\\\"https://reactjs.org\\\">React</a></li>\\n</ul>\"},\"site\":{\"siteMetadata\":{\"facebook\":{\"appId\":\"238555440035867\"}}}},\"pathContext\":{\"slug\":\"/2018-02-04-postgres-transaction-aborted-commands-ignored-error/\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---2018-02-04-postgres-transaction-aborted-commands-ignored-error-ed984a5062f3908888e9.js","module.exports = {\"data\":{\"post\":{\"id\":\"/Users/thanhchungbui/Desktop/thanhchungbtcblog/content/posts/2018-02-04-postgres-transaction-aborted-commands-ignored-error/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>先日Postgres マネジャーツールでクエリを実行する時下記のエラーが出てきました。</p>\\n<blockquote>\\n<p>current transaction is aborted, commands ignored until end of transaction block\\nその後は正常なクエリを打ったのに何も実行できず、困っていました。</p>\\n</blockquote>\\n<p>これはトランザクションの中に一度エラーが発生すると、明示的にでトランザクションを終了させないと（<code class=\\\"language-text\\\">abort</code>,<code class=\\\"language-text\\\">commit</code>）次のクエリは受け取らないようです。\\n例えば</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-sql\\\"><code class=\\\"language-sql\\\"><span class=\\\"token keyword\\\">begin</span><span class=\\\"token punctuation\\\">;</span>\\nselet <span class=\\\"token operator\\\">*</span> <span class=\\\"token keyword\\\">from</span> foo<span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>を実行としましょう。\\nすると、「ERROR: syntax error at or near ‘selet’“」というエラーが投げられます。\\nここでクエリを修正し、再度実行します。\\n<code class=\\\"language-text\\\">select * from foo;</code>\\nでも冒頭のメッセージが出て、実行ができません。\\nトランザクションの中でエラーが発生した場合\\n<code class=\\\"language-text\\\">rollback</code>\\nで一度終了させる必要があるという意味です。\\nさ、これで再度実行してみましょう。</p>\\n<p>このエラーはもし<code class=\\\"language-text\\\">psql</code>で実行すればすぐわかると思うんだけど、<code class=\\\"language-text\\\">pgAdmin</code>等でクエリを試したらなかなか気づきにくく、知っておけばよかったと思います。</p>\\n<p><a href=\\\"%60transaction%60%E3%81%AE%E5%87%A6%E7%90%86\\\">https://github.com/postgres/postgres/blob/master/src/backend/access/transam/README</a>によると、でユーザーが中止するとシステムの具合で中止する処理は区別しているようです。</p>\\n<blockquote>\\n<ul>\\n<li>AbortCurrentTransaction (システムの都合）アプリケーション状態はTBLOCK_ABORT</li>\\n<li>UserAbortTransactionBlock (ユーザーが<code class=\\\"language-text\\\">rollback</code>や<code class=\\\"language-text\\\">commit</code>を実行）アプリケーション状態はTBLOCK<em>ABORT</em>END</li>\\n</ul>\\n</blockquote>\\n<p>では、なんでその場合<code class=\\\"language-text\\\">postgres</code>は自動にTransactionを終了させてくれないの？こうすると毎回Syntaxとかタイプミス等で<code class=\\\"language-text\\\">rollback</code>を打たないといけなく、面倒くさいなと思うんでしょう。\\n例えば、長いトランザクションの中にタイプミスで最初から始めないといけないとなら。。。\\nもし<code class=\\\"language-text\\\">psql</code>を使用したら<code class=\\\"language-text\\\">onerrorrollback</code>という設定を指定することで自動に<code class=\\\"language-text\\\">rollback</code>してくれます。</p>\\n<p>詳しく読みたい場合は<a href=\\\"OnErrorRollBack%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%EF%BC%88%E8%91%97%E4%BD%9C%E8%80%85%E3%81%AE%E3%83%96%E3%83%AD%E3%82%B0%EF%BC%89\\\">https://www.endpoint.com/blog/2015/02/24/postgres-onerrorrollback-explained</a>をご参照ください。</p>\",\"fields\":{\"slug\":\"/2018-02-04-postgres-transaction-aborted-commands-ignored-error/\",\"prefix\":\"\"},\"frontmatter\":{\"title\":\"postgres: current transaction is aborted, commands ignored until end of transaction block\",\"subTitle\":null,\"cover\":null}},\"author\":{\"id\":\"/Users/thanhchungbui/Desktop/thanhchungbtcblog/content/parts/author.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>My name is <strong>Thanh Chung</strong>, a Web Developer. I love reactjs and javascript stacks but it’s really hard. English is not my first language but this blog is aimed to improve my writing skill.</p>\"},\"footnote\":{\"id\":\"/Users/thanhchungbui/Desktop/thanhchungbtcblog/content/parts/footnote.md absPath of file >>> MarkdownRemark\",\"html\":\"<ul>\\n<li>this blog is forked from   <a href=\\\"https://github.com/greglobinski/gatsby-starter-personal-blog\\\">gatsby-starter-personal-blog-starter-kit</a></li>\\n<li>built by <a href=\\\"https://www.greglobinski.com\\\">greg lobinski</a></li>\\n<li>with <a href=\\\"https://www.gatsbyjs.org/\\\">Gatsby</a> &#x26; <a href=\\\"https://reactjs.org\\\">React</a></li>\\n</ul>\"},\"site\":{\"siteMetadata\":{\"facebook\":{\"appId\":\"238555440035867\"}}}},\"pathContext\":{\"slug\":\"/2018-02-04-postgres-transaction-aborted-commands-ignored-error/\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/2018-02-04-postgres-transaction-aborted-commands-ignored-error.json\n// module id = 854\n// module chunks = 249920095221113"],"sourceRoot":""}